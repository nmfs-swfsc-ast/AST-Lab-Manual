[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "CPS Acoustic Classification",
    "section": "",
    "text": "Welcome\nLast updated: 2024-12-16 20:30:30 UTC\n[[[enter cool image of CPS survey]]]\nWest Coast coastal pelagic species play an important role in the California Current ecosystem. They’re food sources for marine mammals, sea birds, and larger fish, and they support commercial and recreational fisheries. The biomass and abundance estimates derived from this project are used in stock assessment models to support sustainable fisheries.",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "index.html#document-objective",
    "href": "index.html#document-objective",
    "title": "CPS Acoustic Classification",
    "section": "Document Objective:",
    "text": "Document Objective:\nThis resource will serve as a tutorial to demonstrate how the SWFSC uses acoustic data generate biomass estimates of Coastal Pelagic Species from Baja, Mexico to Vancouver, Canada.\nAs part of our commitment to open science, reproducibility, and transparency, we provide this metadata guide to compliment our public-domain data.\n\nPlease consider this resource to be a Living Document. The code in this repository is regularly being updated and improved. \n\nDo not hesitate to reach out (to us at either alice.beittel@noaa.gov or GitHub issues, especially if you find discrepancies in the data or want to suggest improvements to infrastructure. Thank you in advance for your collaboration and partnership with us as we develop our future data universe.",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "index.html#user-resources",
    "href": "index.html#user-resources",
    "title": "CPS Acoustic Classification",
    "section": "User Resources",
    "text": "User Resources",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "index.html#cite-this-data",
    "href": "index.html#cite-this-data",
    "title": "CPS Acoustic Classification",
    "section": "Cite This Data",
    "text": "Cite This Data\n[enter text on how to do this]",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "index.html#noaa-readme",
    "href": "index.html#noaa-readme",
    "title": "CPS Acoustic Classification",
    "section": "NOAA README",
    "text": "NOAA README\nThis repository is a scientific product and is not official communication of the National Oceanic and Atmospheric Administration, or the United States Department of Commerce. All NOAA GitHub project code is provided on an ‘as is’ basis and the user assumes responsibility for its use. Any claims against the Department of Commerce or Department of Commerce bureaus stemming from the use of this GitHub project will be governed by all applicable Federal law. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation or favoring by the Department of Commerce. The Department of Commerce seal and logo, or the seal and logo of a DOC bureau, shall not be used in any manner to imply endorsement of any commercial product or activity by DOC or the United States Government.",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "index.html#noaa-license",
    "href": "index.html#noaa-license",
    "title": "CPS Acoustic Classification",
    "section": "NOAA License",
    "text": "NOAA License\nSoftware code created by U.S. Government employees is not subject to copyright in the United States (17 U.S.C. §105). The United States/Department of Commerce reserve all rights to seek and obtain copyright protection in countries other than the United States for Software authored in its entirety by the Department of Commerce. To this end, the Department of Commerce hereby grants to Recipient a royalty-free, nonexclusive license to use, copy, and create derivative works of the Software outside of the United States.",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "content/background.html",
    "href": "content/background.html",
    "title": "Survey Background",
    "section": "",
    "text": "Who conducts the survey?\nThe California Current Ecosystem Survey is conducted by researchers at the NOAA Southwest Fisheries Science Center from the Fisheries Resources Division. The survey is also made possible by volunteers from additional NOAA line offices and science centers, universities, international partners, NOAA interns, and inter-agency employees.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Survey Background</span>"
    ]
  },
  {
    "objectID": "content/background.html#where-does-the-survey-take-place",
    "href": "content/background.html#where-does-the-survey-take-place",
    "title": "Survey Background",
    "section": "Where does the survey take place?",
    "text": "Where does the survey take place?\n\n\n\n\n\n\n\n\nSardine distribution\n\n\n\n\n\n\n\nGeneral sampling scheme\n\n\n\n\n\n\nFigure 1.1: On left, a conceptual spring (shaded region) and summer (hashed region) distributions of potential habitat for the northern stock of Pacific Sardine along the west coasts of Mexico, the United States, and Canada. On right, the general sampling scheme of planned core-region (solid black lines), adaptive (dashed red lines), and nearshore lines (pink).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Survey Background</span>"
    ]
  },
  {
    "objectID": "content/background.html#research-objectives",
    "href": "content/background.html#research-objectives",
    "title": "Survey Background",
    "section": "Research objectives:",
    "text": "Research objectives:\n\nAcoustically map the distributions, measure the species compositions and size-frequency distributions, and estimate the abundances and biomasses of CPS present in the survey area, e.g., Pacific Sardine Sardinops sagax, Northern Anchovy (Engraulis mordax), Pacifc Herring (Clupea pallasii), Round Herring (Etrumeus acuminatus), Pacific Mackerel (Scomber japonicus), and Jack Mackerel (Trachurus symmetricus)\nCharacterize and investigate linkages to their biotic and abiotic environments\nGather information regarding their life histories\nCompare the species composition and size distributions of trawls and near shore vessel purse seine sets.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Survey Background</span>"
    ]
  },
  {
    "objectID": "content/background.html#survey-history",
    "href": "content/background.html#survey-history",
    "title": "Survey Background",
    "section": "Survey History:",
    "text": "Survey History:\nThe SWFSC’s ATM surveys of CPS in the CCE began in 2006 with a focus on the northern stock of Pacific Sardine. Since then, they have expanded in scope and objectives to include the larger forage-fish assemblage and krill. This evolution, and the migratory behavior of Pacific Sardine, serve to explain the present survey region and design.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Survey Background</span>"
    ]
  },
  {
    "objectID": "content/background.html#code-of-conduct",
    "href": "content/background.html#code-of-conduct",
    "title": "Survey Background",
    "section": "Code of Conduct",
    "text": "Code of Conduct",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Survey Background</span>"
    ]
  },
  {
    "objectID": "content/acquisition.html",
    "href": "content/acquisition.html",
    "title": "Data Acquisition",
    "section": "",
    "text": "Survey Equipment",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data Acquisition</span>"
    ]
  },
  {
    "objectID": "content/acquisition.html#survey-equipment",
    "href": "content/acquisition.html#survey-equipment",
    "title": "Data Acquisition",
    "section": "",
    "text": "Acoustic Instruments\n\n\n\n\n\n\nFigure 2.1: Transducer locations on the bottom of the centerboard aboard Lasker.\n\n\n\nOn Lasker and Shimada, multi-frequency Wideband Transceivers (Simrad EK80 WBTs; Kongsberg) were confgured with split-beam transducers (Simrad ES18, ES38-7, ES70-7C, ES120-7C, ES200-7C, and ES333- 7C on Lasker and ES18, ES38B, ES70-7C, ES120-7C, and ES200-7C on Shimada; Kongsberg). The transducers were mounted on the bottom of a retractable keel or “centerboard” (Figure 2.1). The keel was retracted (transducers ~5-m depth) during calibration, and extended to the intermediate position (transducers ~7-m depth) during the survey. Exceptions were made during shallow water operations, when the keel was retracted; or during times of heavy weather, when the keel was extended (transducers ~9-m depth) to provide extra stability and reduce the efect of weather-generated noise. Transducer position and motion were measured at 5 Hz using an inertial motion unit (Applanix POS-MV; Trimble).\n\n\nUnderway CTD\nOn Lasker and Shimada, conductivity and temperature profiles were measured down to 300 m using calibrated sensors on a probe cast from the vessel while underway (UnderwayCTD, or UCTD; Teledyne Ocean- science). Casts were typically conducted between two to four times along each transect. These data indicate the depth of the surface mixed layer, above which most pelagic CPS reside during the day. These data were also used to estimate the time-averaged sound speed (Demer, 2004), for estimating ranges to the sound scatterers, and frequency-specific sound absorption coefficients, for compensating signal attenuation of the sound pulse between the transducer and scatterers (Simmonds and MacLennan, 2005).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data Acquisition</span>"
    ]
  },
  {
    "objectID": "content/acquisition.html#software",
    "href": "content/acquisition.html#software",
    "title": "Data Acquisition",
    "section": "Software",
    "text": "Software\n\nEchosounder Software\nEK80\n\n\nNetTime\nOn Lasker and Shimada, the computer clocks were synchronized with the GPS clock (UTC) using a synchronization software called NetTime.\n\n\nEAL\nThe 38-, 70-, 120-, 200-, and 333-kHz echosounders were controlled by the EK80 Adaptive Logger (EAL2, Renfree and Demer, 2016). The EAL optimizes the pulse interval based on the seabed depth, while avoiding aliased seabed echoes, and was programmed such that once an hour the echosounders would record three pings in passive mode, for obtaining estimates of the background noise level.\n\n\nK Sync\nTo minimize acoustic interference on Lasker and Shimada, transmit pulses from the EK80s, acoustic Doppler current profiler and echosounder (Simrad-Kongsberg EC150-3C), multibeam echosounder (Simrad- Kongsberg ME70), imaging sonar (Simrad-Kongsberg MS70), scanning sonar (Simrad-Kongsberg SX90), and a separate acoustic Doppler current profiler (Teledyne RD Instruments OS75 ADCP) were triggered using a synchronization system (Simrad K-Sync; Kongsberg). The K-Sync trigger rate, and thus the echosounder ping interval, was modulated by the EAL using the 18-kHz seabed depth provided by the Scientific Computing System (SCS).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data Acquisition</span>"
    ]
  },
  {
    "objectID": "content/acquisition.html#raw-acoustic-data-format",
    "href": "content/acquisition.html#raw-acoustic-data-format",
    "title": "Data Acquisition",
    "section": "Raw Acoustic Data Format",
    "text": "Raw Acoustic Data Format\nMeasurements of volume backscattering strength (Sv; dB re 1 m2 m-3) and target strength (TS; dB re 1 m2), indexed by time and geographic positions provided by GPS receivers, were stored in Simrad-Kongsberg .raw format with a 1-GB maximum file size. During daytime, the echosounders operated in CW mode and logged to 60 m beyond the detected seabed range or to a maximum range of 500, 500, 500, 300, and 150 m for 38, 70, 120, 200, and 333 kHz, respectively. During nighttime, the echosounders operated in FM mode and logged to 100 m. For each acoustic instrument, the prefix for each fle name is a concatenation of the survey name (e.g., 2307RL), the operational mode (CW or FM), and the logging commencement date and time from the EK80 software (v21.15.1). For example, a file generated by the Simrad-Kongsberg EK80 software for a WBT operated in CW mode is named 2307RL_CW-D20220826-T155651.raw.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data Acquisition</span>"
    ]
  },
  {
    "objectID": "content/workflow.html",
    "href": "content/workflow.html",
    "title": "Data Workflow",
    "section": "",
    "text": "Data pipeline from boat to shore to report",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data Workflow</span>"
    ]
  },
  {
    "objectID": "content/preparation.html",
    "href": "content/preparation.html",
    "title": "Data Preparation",
    "section": "",
    "text": "Select regions of interest\n\nSelect data on transect lines\n\n\nIntegration stop and start lines",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Data Preparation</span>"
    ]
  },
  {
    "objectID": "content/processing.html",
    "href": "content/processing.html",
    "title": "Data Processing",
    "section": "",
    "text": "After data aqusition, we identify acoustic echos of schooling CPS using a semi-automated data processing algorithm using Echoview software and in-house Posit code in the estimATM repository. With Echoview, we extract the backscatter of swim bladder fish and process using soundspeed and echosounder calibration values housed inside an Echoview Calibration Supplement (.ecs) file. The Echoview filters and thresholds were based on a sub-sample of echoes from randomly selected CPS schools. We complete the processing with the estimATM package in extract_CPS_NASC.R, where we further refine the backscatter selection to extract only CPS. Here we will cover the Echoview and estimATM semi-automated processing workflow.\n\nData Processing Overview\n\n\n\nOverview of CPS Acoustic Processing\n\n\n\n\nEchoview Processing Workflow\n\nSemi-Automated Processing in Echoview\nIn Echoview, we organize, clean, and extract acoustic backscatter of swim bladdered fish. There are three key steps to this process: 1) Data wrangling, cleaning, and noise removal (including surface noise and seabed removal), 2) Echo classification for swim-bladdred fish, and 3) Acoustic Backscatter Integration. The aim of the filter criteria is to retain at least 95% of the noise-free backscatter from CPS while rejecting at least 95% of the non-CPS backscatter.\n\n\n\nSimplified dataflow of processing in Echoview. *Surface noise and seabed removal replies on two manual inputs: the Integration Start and Integration Stop lines (not pictured, see step 5).\n\n\n\n\nSection 1) Data Wrangling, Cleaning, and Noise Removal:\n\nLoad RAW EK80 acoustic data and Echoview Calibration Supplement (.ecs)file into Echoview. The .ecs file contains soundspeed information calculated from the nearest (temporally and spatially) Underway CTD cast and echosounder calibration parameters. This file is used at the very beginning to convert from power to Sv (volume-backscattering coefficient).\nAlign sampling rate (time and geometery) from all transders to the 38 kHz Sv. Acousticians call this step ‘matching geometry’ of all Sv variables. Making sure pings are aligned from all echosounders is important for calculating the frequency response of backscatter in steps later on.\nRemove passive-mode pings.\nNoise removal: estimate and subtract background noise using the background noise removal function (De Robertis and Higginbottom, 2007).\nSurface noise and seabed removal is completed by manually drawing an Integration Start and Integration Stop line in Echoview. The Integration Start line is drawn at the shallowest depth to include surface CPS schools but exclude transducer ring down and surface noise due to sea state (typically around 5 meters below the transducer face or ~10m depth). The Integration Stop line is drawn closest to the seabed to include bottom dwelling animals but exclude any non-living seabed features (typically 3 m above the estimated seabed (Demer et al., 2009), or to the maximum logging range (e.g., 350 m), whichever is shallowest). When drawing the lines, we set the color scale to a minimum Sv threshold of -60 dB which corresponds to a density of approximately three 20-cm-long Pacific Sardine per 100 m3). Doing this helps visually pick out schools from the seabed and from non-swim bladder animals that appear as diffuse scattering layers in the water column. The area of the water column between the two lines sets the depth range that will be integrated for swim bladder fish in steps later on.\nAverage the noise-free Sv echograms using non-overlapping 11-sample by 3-ping bins.\nExpand the averaged, noise-reduced Sv echograms with a 7 pixel x 7 pixel dilation. This replaces each averaged datapoint from Step 6 with the maximum datapoint surrounding it in a 7x7 pixel region.\n\n\n\nSection 2) Echo Classification for Swim Bladder Fish\n\nCalculate Frequency Response:\n\nFor each dilated pixel, compute:\nSv 200kHz − Sv 38kHz\nSv 120kHz − Sv 38kHz\nSv 70kHz − Sv 38kHz\nThe difference between Sv values provides the frequency response for those pixels. Swim bladder fish have a unique frequency response which we can use extract those acoustic returns in the next step. Acoustic returns that fall within the Sv ranges below are flagged as meeting the criteria for typical swim bladder fish, including CPS.\nCreate a Boolean echogram for Sv differences in the CPS range:\n−13.85 &lt; Sv 70kHz − Sv 38kHz &lt; 9.89\n− 13.5 &lt; Sv 120kHz −Sv 38kHz &lt; 9.37\n− 13.51 &lt; Sv 200kHz − Sv 38kHz &lt; 12.53\n\n\n\nCalculate Standard Deviation:\n\nFor 120 and 200 kHz, compute the squared difference between the noise-filtered Sv (remove passive pings) and averaged Sv (11-sample x 3 ping bin averages).\nAverage the results using an 11-sample by 3-ping window to derive variance.\nCompute the square root to derive the 120- and 200-kHz standard deviations (σ120kHz and σ200kHz, respectively).\nExpand the standard deviation echograms with a 7 pixel x 7 pixel dilation (same step as Section 1, Step 7).\nCreate a Boolean echogram based on the standard deviations in the CPS range:\nσ120kHz &gt; -65 dB\nσ200kHz &gt; -65 dB\nDiffuse backscattering layers have low σ (Zwolinski et al., 2010) whereas fish schools have high σ. Intersect the two Boolean echograms to create an echogram with “TRUE” samples for candidate CPS schools and “FALSE” elsewhere. Mask the noise-reduced echograms using the CPS Boolean echogram .\n\n\n\n\nSection 3) Acoustic Backscatter Integration\n\nIntegrate the volume backscattering coefficients (sV , m2 m-3) attributed to CPS over 5-m depths and averaged over 100-m distances;\nOutput the resulting nautical area scattering coefficients (sA; m2 nmi-2) and associated information from each transect and frequency to comma-delimited text (.csv) files.\n\n\n\n\nPosit Processing Workflow\nextract_CPS_NASC.R is an R-based tool in the estimATM package to retain only CPS backscatter from the integrated Echoview data.\n\nEchoes from fishes with swimbladders (blue points, scaled by backscatter intensity) along an example acoustic transect (top) and the corresponding echogram image (bottom). In this example, the upper (blue) and lower lines (green) indicate boundaries within which echoes were retained. When the lower boundary is deeper than the seabed (black line), echoes above the seabed are retained. Echoes from deep, bottom-dwelling schools of non-CPS fishes with swimbladders, and from diffuse scatters near the surface were excluded. The proximity of the echoes to the seabed was also used to define the lower limit for vertical integration.\nIn the plot window, you can now draw new integration stop (green) and start (blue) lines. Use the crosshair cursor to click along the plot to draw a new integration stop line, then right-click and select “Stop” to complete the line. Blue points that fall below this line will be excluded from the resulting CSV file. You want to remove backscatter that you believe are not CPS (e.g., rockfishes, hake) or possibly contain seabed. Next, draw a lnew top integration line (if desired) to remove any surface noise or diffuse scattering layers. If you say no to drawing this line, it will create a line at the surface and include all backscatter below. If you don’t like either line, you can respond “No” when it asks if the line looks good, and redraw the line. Rinse and repeat until you are satisfied.\n\nOnce you are happy with the two lines, an image will appear showing the results of your editing. If the backscatter needs to be removed, or put back, you can re-run the script and the results will be replaced.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Data Processing</span>"
    ]
  },
  {
    "objectID": "content/identification.html",
    "href": "content/identification.html",
    "title": "Backscatter Identification",
    "section": "",
    "text": "A picture guide for helping decipher tricky backscatter in the R script extract_CPS_NASC.R and Echoview processing.\n\nBuild out from this google document.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Backscatter Identification</span>"
    ]
  }
]